# 传输层： UDP TCP  数据怎么在网络中传输

# UDP协议
udp协议是面向无对象的，也就是说不需要在正式传递数据之前就连接对方，udp只负责数据包的搬运，不保证数据包的有序或丢失


- 面向无对象
  不需要三次握手


发送端: 应用层(浏览器) --> 传输层(UDP) 给数据增加UDP标记，然后给网络层
接收端: 网络层 --> 传输层 --> 干掉UDP标识 --> 应用层

- 不可靠性
  1. 无连接
  2. 不解析数据
  3. 没有拥塞控制
- 高效性
  1. 不需要保证数据不会丢失且有序
  2. 头部开销小，只有八字节。而TCP至少20字节

- 传输方式
  1. 一对一
  2. 一对多
  3. 多对多
  4. 多对一

# 总结  UDP特点：它的不可靠性恰恰造成了他的优点：高效性




# TCP协议
  要建立连接，传输过程有各种算法保证数据的可靠性，没有UDP高效

  - 可靠性
  1. 有连接
  2. 解析数据
  3. 拥塞控制

  - 三次握手
    1. 客户端向服务端发送连接请求
    2. 服务端向客户端发送请求应答
    3. 客户端接收到应答后，向服务端发送确认报文(确认建立了连接)

# 为什么TCP建立连接需要三次握手？明明两次就建立了连接
客户端发送连接请求A，因为网络原因没有到达服务器，那么TCP会启动超时重传机制，重新发送一个连接B，当B顺利到达服务端后，建立了连接，当数据传输完成后断开连接，这时候A才到达服务器，服务端就会认为客户端又想建立连接，于是服务端给予响应，但是此时客户端已经关闭，服务端会一直等待，造成资源浪费。

  - 四次挥手
    1. 客户端向服务端发送连接释放请求
    2. 服务端接收到释放请求，告知应用层要释放TCP连接了，就会发送ACK包，并进入CLOSE_wait状态(客户端是不能向服务端发数据了，但服务端可以想客户端发送数据)
    3. 如果有数据没传完，服务器继续把这最后一次数据传递到客户端。
    4. 客户端接收到最后一次数据后向服务端发起确认断开请求，2ms后如果没有得到一应答，就会自动断开。